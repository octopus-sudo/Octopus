<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Lançamento de Vendas</title>
</head>
<body>
  <h2>Enviar texto para a planilha</h2>
  <form id="form-venda">
    <input name="texto" id="texto" placeholder="Digite algo" required>
    <button type="submit">Enviar</button>
  </form>

  <p id="mensagem" style="color: green;"></p>

  <script>
    const form = document.getElementById('form-venda');
    const mensagem = document.getElementById('mensagem');

    form.addEventListener('submit', function(e) {
      e.preventDefault(); // Impede o envio padrão

      const dados = new FormData(form);

      fetch('https://script.google.com/macros/s/AKfycbxJOijjWNokPnWcJ8prcLNOMUo_wwE0eRubp2qqXrVdC2UMpuFthAySKU4XVwaVRbn6PQ/exec', {
        method: 'POST',
        body: dados
      })
      .then(response => response.text())
      .then(texto => {
        mensagem.textContent = "Venda registrada com sucesso!";
        form.reset(); // Limpa os campos
      })
      .catch(error => {
        mensagem.textContent = "Erro ao registrar venda.";
        mensagem.style.color = "red";
      });
    });
  </script>
</body>
</html>
