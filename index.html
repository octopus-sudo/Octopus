<body>
  <h1 style="font-size: 32px; text-align: center; color: #4B0082; font-family: Arial, sans-serif; text-shadow: 2px 2px 4px #888;">
    Loja Octopus
  </h1>
  <h5 style="text-align: center; color: #4B0082; font-family: Arial, sans-serif;">
    :v_005
  </h5>

  <h2 style="text-align: center; text-transform: uppercase; color: #36454F; font-family: Arial, sans-serif;">
    Registrar Venda
  </h2>

  <!-- Agrupamento visual -->
  <div style="display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 20px;">
    <input type="text" id="vendaInput" placeholder="Digite a venda"
      style="padding: 10px; font-size: 16px; width: 250px; border: 1px solid #ccc; border-radius: 6px; font-family: Arial;">
    
    <button id="botaoEnviar" onclick="registrarVenda()"
      style="padding: 10px 20px; font-size: 16px; background-color: #4B0082; color: white; border: none; border-radius: 6px; cursor: pointer; font-family: Arial;">
      Enviar
    </button>

    <p id="mensagem" style="font-size: 14px; color: #006400; font-family: Arial;"></p>
  </div>

  <script>
    function registrarVenda() {
      const texto = document.getElementById("vendaInput").value;
      const botao = document.getElementById("botaoEnviar");
      const mensagem = document.getElementById("mensagem");

      if (!texto.trim()) {
        mensagem.textContent = "Por favor, digite uma venda.";
        return;
      }

      botao.disabled = true;
      botao.textContent = "Enviando...";

      fetch("https://script.google.com/macros/s/AKfycbwXppHw4j12FerhCixxP4CC2YkRihdxIGSpGpdT-ScBwbIGEmF3EmPhE5tjJmvGhUHi3g/exec", {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: "texto=" + encodeURIComponent(texto)
      })
      .then(response => response.text())
      .then(data => {
        mensagem.textContent = "Venda registrada com sucesso!";
        document.getElementById("vendaInput").value = "";

        setTimeout(() => {
          mensagem.textContent = "";
        }, 3000);
      })
      .catch(error => {
        mensagem.textContent = "Erro ao registrar venda.";
        console.error("Erro:", error);

        setTimeout(() => {
          mensagem.textContent = "";
        }, 3000);
      })
      .finally(() => {
        botao.disabled = false;
        botao.textContent = "Enviar";
      });
    }
  </script>
</body>
